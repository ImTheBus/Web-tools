<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Executive Alignment Dashboard ‚Äì IMTHEBUS Tools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Shared base styles and core helpers -->
  <link rel="stylesheet" href="assets/imthebus-base.css" />
  <script src="assets/imthebus-core.js" defer></script>

  <style>
    /* Page layout: single full-width whiteboard canvas */
    .page.silly-dashboard-page {
      grid-template-columns: minmax(0, 1fr);
      gap: 14px;
    }

    .silly-board {
      position: relative;
      min-height: clamp(520px, 72vh, 820px);
      padding: 14px 16px 20px;
      /* drawn directly on whiteboard background; no extra frames */
    }

    /* Header scribbles */
    .silly-title-row {
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 6px;
    }

    .silly-title-main {
      font-family: "Archivo Black", system-ui, sans-serif;
      font-size: 1.5rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .silly-title-tag {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      padding: 3px 8px;
      border-radius: var(--radius-pill);
      border: 2px solid var(--border-strong);
      background: rgba(255, 255, 255, 0.9);
    }

    .silly-subtitle {
      font-size: 0.84rem;
      max-width: 640px;
      color: var(--accent-soft);
      margin-bottom: 10px;
    }

    .silly-pencil-note {
      font-family: "Permanent Marker", system-ui, sans-serif;
      font-size: 0.9rem;
      color: var(--accent-soft);
      margin-bottom: 10px;
    }

    /* Marker colour helpers ‚Äì using existing palette values as marker inks */
    .marker-green {
      color: var(--q-do);
    }
    .marker-blue {
      color: var(--q-schedule);
    }
    .marker-yellow {
      color: var(--q-delegate);
    }
    .marker-pink {
      color: var(--q-delete);
    }
    .marker-neutral {
      color: var(--accent-soft);
    }

    /* Top KPI strip: drawn as marker headings across the board */
    .silly-kpi-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      margin-bottom: 12px;
    }

    .silly-kpi {
      padding: 4px 4px 6px;
      border-bottom: 2px solid var(--border-strong);
      position: relative;
    }

    .silly-kpi-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.11em;
      margin-bottom: 2px;
    }

    .silly-kpi-value {
      font-size: 1.3rem;
      font-weight: 600;
      line-height: 1.1;
    }

    .silly-kpi-subtext {
      font-size: 0.75rem;
      color: var(--accent-soft);
      margin-top: 2px;
    }

    .silly-kpi-under {
      position: absolute;
      left: 0;
      right: 0;
      bottom: -4px;
      height: 2px;
      border-bottom: 1px dashed rgba(0, 0, 0, 0.35);
      transform: skewX(-5deg);
      pointer-events: none;
    }

    /* Middle band: left chart, right API feed on sticky notes */
    .silly-middle-band {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(220px, 1.1fr);
      gap: 16px;
      margin-bottom: 14px;
    }

    @media (max-width: 900px) {
      .silly-middle-band {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    /* Chart area: sketched box with axis lines on board */
    .silly-chart-area {
      position: relative;
      padding: 10px 10px 12px;
      border: 1px solid var(--border-strong);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.85);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.16);
    }

    .silly-chart-title {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: baseline;
      margin-bottom: 6px;
    }

    .silly-chart-title-main {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .silly-chart-meta {
      font-size: 0.75rem;
      color: var(--accent-soft);
      text-align: right;
    }

    .silly-chart-grid {
      position: relative;
      padding: 6px 4px 0;
      margin-bottom: 6px;
      height: 170px;
    }

    .silly-chart-grid::before,
    .silly-chart-grid::after {
      content: "";
      position: absolute;
      background: rgba(0, 0, 0, 0.18);
    }

    .silly-chart-grid::before {
      left: 8%;
      right: 4%;
      top: 50%;
      height: 1px;
    }

    .silly-chart-grid::after {
      top: 8%;
      bottom: 8%;
      left: 10%;
      width: 1px;
    }

    .chart-bars {
      position: absolute;
      inset: 0 4px 0 14px;
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 8px;
      align-items: flex-end;
    }

    .chart-bar-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      font-size: 0.7rem;
    }

    .chart-bar {
      width: 100%;
      border-radius: 4px 4px 2px 2px;
      background:
        linear-gradient(
          to top,
          var(--accent-primary-soft),
          rgba(0, 0, 0, 0.85)
        );
      min-height: 10px;
      transition: height 0.35s ease;
    }

    .chart-bar-value {
      font-size: 0.75rem;
    }

    .chart-bar-label {
      font-size: 0.7rem;
      color: var(--accent-soft);
    }

    .silly-chart-legend {
      font-size: 0.75rem;
      color: var(--accent-soft);
      margin-bottom: 5px;
    }

    .silly-chart-ticker {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 6px;
      border-radius: var(--radius-pill);
      border: 1px solid var(--border-strong);
      font-size: 0.75rem;
      max-width: 100%;
    }

    .silly-ticker-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--q-do);
    }

    .ticker-label {
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-size: 0.7rem;
      color: var(--accent-soft);
    }

    .ticker-text {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* API column on sticky notes */
    .silly-api-column {
      position: relative;
      min-height: 180px;
    }

    .silly-api-title {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .silly-api-meta {
      font-size: 0.75rem;
      color: var(--accent-soft);
      margin-bottom: 8px;
    }

    .silly-api-notes {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 8px;
    }

    .silly-api-note {
      position: relative;
      min-width: 0;
    }

    .silly-api-note .note {
      position: relative;
      min-width: 100%;
      max-width: none;
      transform: rotate(var(--note-rot, -1deg));
      cursor: default;
    }

    .silly-api-note .note-title {
      font-size: 0.78rem;
      margin-bottom: 2px;
    }

    .silly-api-note .api-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .api-content {
      font-size: 0.8rem;
      line-height: 1.35;
    }

    .api-error {
      font-style: italic;
      color: var(--accent-soft);
    }

    /* Lower band: table, culture pulse, and territory notes */
    .silly-lower-band {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(220px, 1.3fr);
      gap: 16px;
      margin-bottom: 10px;
    }

    @media (max-width: 900px) {
      .silly-lower-band {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    /* Table area: sketched table on the board */
    .silly-table-area {
      padding: 8px 8px 10px;
      border: 1px solid var(--border-strong);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.88);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.16);
    }

    .silly-table-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 6px;
    }

    .silly-table-title {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .silly-table-meta {
      font-size: 0.75rem;
      color: var(--accent-soft);
      text-align: right;
    }

    .fake-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.78rem;
      margin-bottom: 4px;
    }

    .fake-table th,
    .fake-table td {
      border: 1px solid rgba(0, 0, 0, 0.6);
      padding: 3px 4px;
      white-space: nowrap;
      vertical-align: middle;
    }

    .fake-table th {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      background: rgba(255, 255, 255, 0.9);
    }

    .fake-table tbody tr:nth-child(2n) {
      background: rgba(0, 0, 0, 0.035);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 1px 6px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(0, 0, 0, 0.7);
      font-size: 0.7rem;
      gap: 4px;
      background: #ffffff;
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
    }

    .badge-dot.green {
      background: var(--q-do);
    }
    .badge-dot.amber {
      background: var(--q-delegate);
    }
    .badge-dot.red {
      background: var(--q-delete);
    }

    .silly-table-footer {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.72rem;
      color: var(--accent-soft);
    }

    /* Culture and territory stack: gif strip plus sticky notes */
    .silly-right-stack {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 10px;
    }

    .silly-culture-block {
      padding: 8px 8px 10px;
      border-radius: 8px;
      border: 1px solid var(--border-strong);
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.18);
    }

    .silly-culture-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 6px;
    }

    .silly-culture-title {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .silly-culture-meta {
      font-size: 0.75rem;
      color: var(--accent-soft);
      text-align: right;
    }

    .silly-culture-inner {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .gif-wrapper {
      flex-shrink: 0;
      width: 150px;
      height: 100px;
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid var(--border-strong);
      background: rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .gif-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .gif-quote {
      flex: 1;
      font-size: 0.83rem;
    }

    .gif-quote span {
      display: block;
      margin-top: 3px;
      font-size: 0.75rem;
      color: var(--accent-soft);
    }

    .employee-grid {
      display: grid;
      grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
      gap: 8px;
      margin-top: 8px;
    }

    @media (max-width: 600px) {
      .employee-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .employee-card {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 5px 6px;
      border-radius: 8px;
      border: 1px dashed rgba(0, 0, 0, 0.7);
      background: rgba(255, 255, 255, 0.85);
    }

    .employee-avatar {
      width: 44px;
      height: 44px;
      border-radius: 999px;
      overflow: hidden;
      border: 2px solid rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.05);
      flex-shrink: 0;
    }

    .employee-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .employee-avatar.happy {
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
    }

    .employee-avatar.sad {
      filter: grayscale(0.7) brightness(0.95);
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.45);
    }

    .employee-info {
      display: flex;
      flex-direction: column;
      gap: 1px;
    }

    .employee-title {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--accent-soft);
    }

    .employee-name {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .employee-role {
      font-size: 0.78rem;
      color: var(--accent-soft);
    }

    /* Territory sticky note */
    .silly-flag-note .note {
      position: relative;
      min-width: 100%;
      max-width: none;
      transform: rotate(var(--note-rot, 1deg));
      cursor: default;
    }

    .flag-panel-content {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      font-size: 0.85rem;
    }

    .flag-emoji {
      font-size: 1.6rem;
    }

    .flag-text-main {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .flag-text-sub {
      font-size: 0.8rem;
      color: var(--accent-soft);
    }

    .flag-meta {
      font-size: 0.75rem;
      color: var(--accent-soft);
      margin-bottom: 3px;
    }

    /* Disclaimers at the bottom of the board */
    .silly-footer-notes {
      margin-top: 6px;
      font-size: 0.75rem;
      color: var(--accent-soft);
    }
  </style>
</head>

<body data-counter-key="exec-dashboard">
  <header data-include="assets/header.html"></header>

  <main class="page silly-dashboard-page">
    <section class="silly-board" aria-label="Executive alignment scribble dashboard">
      <div class="silly-title-row">
        <div>
          <div class="silly-title-main marker-blue">Executive Alignment Dashboard</div>
        </div>
        <div class="silly-title-tag marker-neutral">
          Experimental ¬∑ Visual noise for people who enjoy dashboards a little too much
        </div>
      </div>

      <p class="silly-subtitle">
        A completely serious, allegedly data informed cockpit that looks impressive at a glance
        and becomes steadily more suspicious the longer you read it.
      </p>
      <p class="silly-pencil-note marker-neutral">
        Note to self: if anyone tries to use this to make an actual decision, schedule an intervention.
      </p>

      <!-- Top marker KPI strip -->
      <section class="silly-kpi-row" aria-label="Key performance indicators drawn on whiteboard">
        <article class="silly-kpi">
          <div class="silly-kpi-label marker-blue">Synergy index</div>
          <div class="silly-kpi-value marker-blue" id="kpi-synergy"></div>
          <div class="silly-kpi-subtext" id="kpi-synergy-sub"></div>
          <div class="silly-kpi-under"></div>
        </article>

        <article class="silly-kpi">
          <div class="silly-kpi-label marker-green">Meetings avoided</div>
          <div class="silly-kpi-value marker-green" id="kpi-meetings"></div>
          <div class="silly-kpi-subtext" id="kpi-meetings-sub"></div>
          <div class="silly-kpi-under"></div>
        </article>

        <article class="silly-kpi">
          <div class="silly-kpi-label marker-yellow">Slide deck velocity</div>
          <div class="silly-kpi-value marker-yellow" id="kpi-slides"></div>
          <div class="silly-kpi-subtext" id="kpi-slides-sub"></div>
          <div class="silly-kpi-under"></div>
        </article>

        <article class="silly-kpi">
          <div class="silly-kpi-label marker-pink">Coffee to insight ratio</div>
          <div class="silly-kpi-value marker-pink" id="kpi-coffee"></div>
          <div class="silly-kpi-subtext" id="kpi-coffee-sub"></div>
          <div class="silly-kpi-under"></div>
        </article>

        <article class="silly-kpi">
          <div class="silly-kpi-label marker-neutral">Revenue per remaining daylight hour</div>
          <div class="silly-kpi-value marker-neutral" id="kpi-daylight"></div>
          <div class="silly-kpi-subtext" id="kpi-daylight-sub"></div>
          <div class="silly-kpi-under"></div>
        </article>
      </section>

      <!-- Middle band: chart plus API feed -->
      <section class="silly-middle-band">
        <!-- Chart area -->
        <article class="silly-chart-area" aria-label="Quarterly strategic buzzword penetration chart">
          <div class="silly-chart-title">
            <div class="silly-chart-title-main">
              Quarterly strategic buzzword penetration
            </div>
            <div class="silly-chart-meta" id="chart-meta"></div>
          </div>

          <div class="silly-chart-grid">
            <div class="chart-bars" aria-hidden="true">
              <div class="chart-bar-group">
                <div class="chart-bar" id="bar-q1"></div>
                <div class="chart-bar-value" id="bar-q1-val"></div>
                <div class="chart-bar-label">Q1</div>
              </div>
              <div class="chart-bar-group">
                <div class="chart-bar" id="bar-q2"></div>
                <div class="chart-bar-value" id="bar-q2-val"></div>
                <div class="chart-bar-label">Q2</div>
              </div>
              <div class="chart-bar-group">
                <div class="chart-bar" id="bar-q3"></div>
                <div class="chart-bar-value" id="bar-q3-val"></div>
                <div class="chart-bar-label">Q3</div>
              </div>
              <div class="chart-bar-group">
                <div class="chart-bar" id="bar-q4"></div>
                <div class="chart-bar-value" id="bar-q4-val"></div>
                <div class="chart-bar-label">Q4*</div>
              </div>
            </div>
          </div>

          <div class="silly-chart-legend">
            <span class="marker-blue">
              Buzzwords per slide (adjusted for font size).
            </span>
            <br />
            <span class="marker-neutral">
              * Q4 heavily forecast using wishful thinking.
            </span>
          </div>

          <div class="silly-chart-ticker" aria-live="polite">
            <span class="silly-ticker-dot"></span>
            <span class="ticker-label">Ticker</span>
            <span class="ticker-text" id="buzzword-ticker"></span>
          </div>
        </article>

        <!-- API feed on sticky notes -->
        <article class="silly-api-column" aria-label="Real time executive intelligence feed">
          <div class="silly-api-title marker-blue">Real time executive intelligence feed</div>
          <div class="silly-api-meta" id="api-meta">
            Contacting very serious data providers...
          </div>

          <div class="silly-api-notes">
            <div class="silly-api-note">
              <div class="note note-q2" style="--note-rot:-1.5deg;">
                <div class="note-title">
                  <span class="api-label marker-blue">Strategic life advice</span>
                </div>
                <div class="api-content" id="api-advice">
                  Loading wisdom...
                </div>
              </div>
            </div>

            <div class="silly-api-note">
              <div class="note note-q3" style="--note-rot:1.2deg;">
                <div class="note-title">
                  <span class="api-label marker-yellow">Morale indicator (dad joke)</span>
                </div>
                <div class="api-content" id="api-joke">
                  Calibrating humor module...
                </div>
              </div>
            </div>

            <div class="silly-api-note">
              <div class="note note-q1" style="--note-rot:-0.8deg;">
                <div class="note-title">
                  <span class="api-label marker-green">Feline risk assessment</span>
                </div>
                <div class="api-content" id="api-catfact">
                  Gathering cat related disruption metrics...
                </div>
              </div>
            </div>
          </div>
        </article>
      </section>

      <!-- Lower band: table plus culture and territory -->
      <section class="silly-lower-band">
        <!-- Table of initiatives -->
        <article class="silly-table-area" aria-label="Top performing initiatives">
          <div class="silly-table-header">
            <div>
              <div class="silly-table-title">Top performing initiatives</div>
            </div>
            <div class="silly-table-meta" id="table-meta"></div>
          </div>

          <table class="fake-table">
            <thead>
              <tr>
                <th>Rank</th>
                <th>Initiative</th>
                <th>Owner</th>
                <th>Confidence</th>
                <th>Impact</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="initiatives-body">
              <!-- Filled by JS -->
            </tbody>
          </table>

          <div class="silly-table-footer">
            <div>
              Numbers look convincing. Please do not attempt to audit the methodology.
            </div>
            <div id="footer-updated"></div>
          </div>
        </article>

        <!-- Culture and territory stack -->
        <div class="silly-right-stack">
          <!-- Culture pulse -->
          <article class="silly-culture-block" aria-label="Culture pulse">
            <div class="silly-culture-header">
              <div class="silly-culture-title">Culture pulse</div>
              <div class="silly-culture-meta" id="culture-meta"></div>
            </div>

            <div class="silly-culture-inner">
              <div class="gif-wrapper">
                <img id="nonsense-gif" src="" alt="Very serious motivational gif">
              </div>
              <div class="gif-quote" id="nonsense-quote">
                Loading unrelated corporate inspiration...
              </div>
            </div>

            <div class="employee-grid" aria-label="Employees of the day">
              <div class="employee-card">
                <div class="employee-avatar happy">
                  <img id="employee-best-avatar" src="" alt="Employee of the day">
                </div>
                <div class="employee-info">
                  <div class="employee-title">Employee of the day</div>
                  <div class="employee-name" id="employee-best-name"></div>
                  <div class="employee-role" id="employee-best-role"></div>
                </div>
              </div>

              <div class="employee-card">
                <div class="employee-avatar sad">
                  <img id="employee-worst-avatar" src="" alt="Least aligned employee of the day">
                </div>
                <div class="employee-info">
                  <div class="employee-title">Least aligned employee of the day</div>
                  <div class="employee-name" id="employee-worst-name"></div>
                  <div class="employee-role" id="employee-worst-role"></div>
                </div>
              </div>
            </div>
          </article>

          <!-- Territory sticky note -->
          <article class="silly-flag-note" aria-label="Latest territory update">
            <div class="note note-q4" style="--note-rot:1.8deg;">
              <div class="note-title flag-meta" id="flag-meta">
                Latest territory update
              </div>
              <div class="flag-panel-content">
                <div class="flag-emoji" id="flag-emoji">üè≥Ô∏è</div>
                <div>
                  <div class="flag-text-main" id="flag-main"></div>
                  <div class="flag-text-sub" id="flag-sub"></div>
                </div>
              </div>
            </div>
          </article>
        </div>
      </section>

      <div class="silly-footer-notes">
        <p>
          This dashboard is for demonstration and amusement. If you are using it to run an actual business,
          you may already be in the panic zone.
        </p>
        <p>
          No personal data is stored by this page. Some anonymous requests are sent to third party joke and fact APIs.
        </p>
      </div>
    </section>
  </main>

  <footer data-include="assets/footer.html"></footer>

  <script>
    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function randomFrom(array) {
      return array[Math.floor(Math.random() * array.length)];
    }

    function formatPercent(value) {
      return value.toFixed(1) + "%";
    }

    function generateKpis() {
      const synergy = randomInt(64, 129);
      const meetings = randomInt(7, 42);
      const slides = randomInt(80, 420);
      const coffee = (Math.random() * 4 + 0.8).toFixed(1);

      const synergySubs = [
        "Cross functional alignment detected in at least two meetings this week.",
        "Synergy elevated through strategic overuse of the word synergy.",
        "Index calibrated against industry leading buzzword saturation levels.",
        "Marginal gains achieved by adding value to added value."
      ];

      const meetingSubs = [
        "Estimated number of calendar events that quietly vanished before becoming a meeting.",
        "Based on canceled invites, vague emails, and people just not turning up.",
        "Includes all meetings replaced by a single well written message.",
        "Trend suggests heroic resistance to calendar bloat."
      ];

      const slideSubs = [
        "Total slide count produced in the last 30 days, real and hypothetical.",
        "Includes backups, alternates, and versions named final_final_v7b.",
        "Velocity spikes whenever someone discovers a new template.",
        "Most slides contain at least one axis that nobody asked for."
      ];

      const coffeeSubs = [
        "Cups per actionable insight, on a rolling 7 day basis.",
        "Calculated during core hours. Weekends omitted for legal reasons.",
        "Ratio improves noticeably when nobody mentions a new initiative.",
        "Currently exceeding safe levels but still within leadership norms."
      ];

      document.getElementById("kpi-synergy").textContent = synergy + " pts";
      document.getElementById("kpi-synergy-sub").textContent = randomFrom(synergySubs);

      document.getElementById("kpi-meetings").textContent = meetings;
      document.getElementById("kpi-meetings-sub").textContent = randomFrom(meetingSubs);

      document.getElementById("kpi-slides").textContent = slides + "/mo";
      document.getElementById("kpi-slides-sub").textContent = randomFrom(slideSubs);

      document.getElementById("kpi-coffee").textContent = coffee;
      document.getElementById("kpi-coffee-sub").textContent = randomFrom(coffeeSubs);

      generateDaylightKpi();
    }

    function generateDaylightKpi() {
      const now = new Date();

      // Rough assumption: pretend Edinburgh sunset is 16:00 local today
      const sunset = new Date(now);
      sunset.setHours(16, 0, 0, 0);

      let hoursLeft = (sunset - now) / 36e5;
      if (isNaN(hoursLeft)) {
        hoursLeft = 4;
      }
      if (hoursLeft <= 0) {
        hoursLeft = 0.5;
      }

      const nonsenseRevenue = randomInt(120000, 980000);
      const perHour = nonsenseRevenue / hoursLeft;

      const valueText = "¬£" + perHour.toLocaleString(undefined, {
        maximumFractionDigits: 0
      }) + "/hr";

      const subVariants = [
        "Total made up revenue divided by an estimated " + hoursLeft.toFixed(1) + " hours of daylight left in Edinburgh.",
        "Indexed to the imaginary turnover per remaining sunny-ish hour above Leith.",
        "Assumes the sun sets over Edinburgh at 16:00, regardless of season or common sense.",
        "Calculated using complex trigonometry and a complete disregard for actual weather."
      ];

      document.getElementById("kpi-daylight").textContent = valueText;
      document.getElementById("kpi-daylight-sub").textContent = randomFrom(subVariants);
    }

    function generateChart() {
      const quarters = [
        { id: "q1", growth: randomInt(18, 72) },
        { id: "q2", growth: randomInt(32, 88) },
        { id: "q3", growth: randomInt(24, 96) },
        { id: "q4", growth: randomInt(40, 130) }
      ];

      const metaPhrases = [
        "Model tuned using last years optimism as a baseline.",
        "Derived from a mix of hard data, soft assumptions, and medium confidence.",
        "Includes uplift from adding the word strategic to three existing projects.",
        "Forecast accuracy estimated at somewhere between 3 and 97 percent."
      ];

      quarters.forEach((q) => {
        const bar = document.getElementById("bar-" + q.id);
        const val = document.getElementById("bar-" + q.id + "-val");

        const height = 16 + q.growth;
        bar.style.height = height + "px";
        val.textContent = formatPercent(q.growth);
      });

      document.getElementById("chart-meta").textContent = randomFrom(metaPhrases);

      const buzzwords = [
        "Unlocking cross functional leverage in the hybrid value stack.",
        "Replatforming core synergies into a more agile mindset pipeline.",
        "Driving asynchronous alignment across the stakeholder surface area.",
        "Operationalizing thought leadership using next wave frameworks.",
        "Decommissioning legacy silos in favor of fully buzzword compliant squads.",
        "Recalibrating KPIs around meaningful vibes and narrative coherence."
      ];
      document.getElementById("buzzword-ticker").textContent = randomFrom(buzzwords);
    }

    function generateTable() {
      const initiatives = [
        "Hybrid Meeting Detox Sprint",
        "Slide Deck Reduction Program",
        "Strategic Coffee Optimization",
        "Inbox Triage Centre of Excellence",
        "Proactive Alignment Standups",
        "Zero Blame Retrospective Guild",
        "Email Subject Line Simplification",
        "Experimental Four Day Calendar",
        "Passive Aggressive Status Dashboard",
        "Continuous Improvement, Occasional Action"
      ];

      const owners = [
        "Taylor", "Jordan", "Alex", "Sam", "Casey", "Morgan"
      ];

      const statuses = [
        { label: "On track", color: "green" },
        { label: "It depends", color: "amber" },
        { label: "Conceptual", color: "amber" },
        { label: "PowerPoint complete", color: "green" },
        { label: "Emotionally delayed", color: "red" },
        { label: "Awaiting alignment", color: "amber" }
      ];

      const tbody = document.getElementById("initiatives-body");
      tbody.innerHTML = "";

      const rows = randomInt(5, 7);
      const usedIndexes = [];

      for (let i = 0; i < rows; i++) {
        let idx;
        do {
          idx = randomInt(0, initiatives.length - 1);
        } while (usedIndexes.includes(idx));
        usedIndexes.push(idx);

        const confidence = randomInt(47, 103);
        const impact = randomInt(1, 10);
        const status = randomFrom(statuses);

        const tr = document.createElement("tr");

        tr.innerHTML = `
          <td>${i + 1}</td>
          <td>${initiatives[idx]}</td>
          <td>${randomFrom(owners)}</td>
          <td>${confidence}%</td>
          <td>${impact}/10</td>
          <td>
            <span class="badge">
              <span class="badge-dot ${status.color}"></span>
              <span>${status.label}</span>
            </span>
          </td>
        `;

        tbody.appendChild(tr);
      }

      const baselines = [
        "Benchmarked against the top 3 percent of PowerPoint centric organizations.",
        "Calibrated using a proprietary blend of gut feel and spreadsheet magic.",
        "Underlying data structure last reviewed at an off site nobody recalls clearly.",
        "Confidence scores are mostly a measure of how convincing the last meeting felt."
      ];

      document.getElementById("table-meta").textContent = randomFrom(baselines);

      const now = new Date();
      document.getElementById("footer-updated").textContent =
        "Last regenerated at " + now.toLocaleTimeString(undefined, {
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit"
        });
    }

    function loadGifAndQuote() {
      const gifUrls = [
        "https://cataas.com/cat/gif",
        "https://cataas.com/cat/cute",
        "https://cataas.com/cat/funny",
        "https://cataas.com/cat/gif?type=sq"
      ];

      const quotes = [
        "If you stare at the dashboard long enough, the dashboard starts managing you.\n\n" +
          "<span>- Ancient Agile Proverb Probably</span>",
        "Reach for the stars. If you miss, you will at least update the slide deck.\n\n" +
          "<span>- Strategic Optimism Department</span>",
        "What gets measured gets pretended to be managed.\n\n" +
          "<span>- Anonymous KPI Enthusiast</span>",
        "Believe in yourself. Everyone else is still waiting for the meeting invite.\n\n" +
          "<span>- Calendar Overlord</span>",
        "Synergy is just teamwork that has had too much coffee.\n\n" +
          "<span>- Chief Caffeine Officer</span>"
      ];

      const gifEl = document.getElementById("nonsense-gif");
      const quoteEl = document.getElementById("nonsense-quote");

      gifEl.src = randomFrom(gifUrls);
      quoteEl.innerHTML = randomFrom(quotes);

      const cultureMetaVariants = [
        "Motivation calibrated using cutting edge animated cat science.",
        "All cultural insights are derived from looping gifs and vibes.",
        "Tested on focus groups consisting entirely of people avoiding real work.",
        "Certified 0 percent evidence based, 100 percent committed."
      ];
      document.getElementById("culture-meta").textContent = randomFrom(cultureMetaVariants);
    }

    async function fetchJson(url, options) {
      try {
        const response = await fetch(url, options);
        if (!response.ok) {
          throw new Error("HTTP " + response.status);
        }
        return await response.json();
      } catch (error) {
        return { error: String(error) };
      }
    }

    async function loadApis() {
      const meta = document.getElementById("api-meta");
      meta.textContent = "Connecting to high integrity joke and fact providers...";

      const [adviceRes, jokeRes, catRes] = await Promise.all([
        fetchJson("https://api.adviceslip.com/advice", { cache: "no-store" }),
        fetchJson("https://icanhazdadjoke.com/", {
          headers: { "Accept": "application/json" },
          cache: "no-store"
        }),
        fetchJson("https://catfact.ninja/fact?max_length=120", { cache: "no-store" })
      ]);

      const adviceEl = document.getElementById("api-advice");
      if (!adviceRes.error && adviceRes.slip && adviceRes.slip.advice) {
        adviceEl.textContent = adviceRes.slip.advice;
      } else {
        adviceEl.innerHTML =
          '<span class="api-error">Advice service unavailable. Consider trusting your instincts instead.</span>';
      }

      const jokeEl = document.getElementById("api-joke");
      if (!jokeRes.error && jokeRes.joke) {
        jokeEl.textContent = jokeRes.joke;
      } else {
        jokeEl.innerHTML =
          '<span class="api-error">Joke API failed. Please reuse a story from three all hands ago.</span>';
      }

      const catEl = document.getElementById("api-catfact");
      if (!catRes.error && catRes.fact) {
        catEl.textContent = catRes.fact;
      } else {
        catEl.innerHTML =
          '<span class="api-error">Could not retrieve cat data. Assume a cat is currently on at least one laptop.</span>';
      }

      meta.textContent = "Feed updated via public APIs. Scientific rigor not included.";
    }

    async function loadEmployees() {
      const result = await fetchJson("https://randomuser.me/api/?results=2&inc=name,picture&noinfo=1", {
        cache: "no-store"
      });

      const bestNameEl = document.getElementById("employee-best-name");
      const bestRoleEl = document.getElementById("employee-best-role");
      const bestAvatarEl = document.getElementById("employee-best-avatar");

      const worstNameEl = document.getElementById("employee-worst-name");
      const worstRoleEl = document.getElementById("employee-worst-role");
      const worstAvatarEl = document.getElementById("employee-worst-avatar");

      const bestRoles = [
        "Chief Headphone Enthusiasm Officer",
        "Director of Positive Vibes in Shared Channels",
        "Senior Beam-From-Behind-The-Glass Specialist",
        "Head of Smiling While Muted",
        "Lead Synchronized Nodding Strategist"
      ];

      const worstRoles = [
        "Vice President of Forgetting To Unmute",
        "Director of Spreadsheet Existential Dread",
        "Chief Passive Aggressive Reply All Architect",
        "Head of Mic Feedback And Echo",
        "Senior Calendar Overbooking Technician"
      ];

      if (!result.error && result.results && result.results.length >= 2) {
        const [best, worst] = result.results;

        bestNameEl.textContent = capitalizeName(best.name);
        bestRoleEl.textContent = randomFrom(bestRoles) + " (with premium noise cancelling)";
        bestAvatarEl.src = best.picture.medium;

        worstNameEl.textContent = capitalizeName(worst.name);
        worstRoleEl.textContent = randomFrom(worstRoles) + " (using laptop mic in a busy cafe)";
        worstAvatarEl.src = worst.picture.medium;
      } else {
        bestNameEl.textContent = "Alex Placeholder";
        bestRoleEl.textContent = randomFrom(bestRoles) + " (stock photo edition)";
        bestAvatarEl.src = "https://cataas.com/cat/says/hi";

        worstNameEl.textContent = "Jordan Fallback";
        worstRoleEl.textContent = randomFrom(worstRoles) + " (rendered entirely from memory)";
        worstAvatarEl.src = "https://cataas.com/cat/sad";
      }
    }

    function capitalizeName(nameObj) {
      if (!nameObj) return "Mystery Colleague";
      const first = nameObj.first || "";
      const last = nameObj.last || "";
      return (first + " " + last).replace(/\b\w/g, function (c) {
        return c.toUpperCase();
      }).trim();
    }

    function loadFlagPanel() {
      const countries = [
        {
          name: "Finland",
          flag: "üá´üáÆ",
          stat: "Drinks more coffee per person than any other country on Earth."
        },
        {
          name: "Japan",
          flag: "üáØüáµ",
          stat: "Has vending machines for almost everything, including hot drinks and business socks."
        },
        {
          name: "New Zealand",
          flag: "üá≥üáø",
          stat: "Has more sheep than people, which is still fewer than your unread emails."
        },
        {
          name: "Canada",
          flag: "üá®üá¶",
          stat: "Apologises so efficiently it may count as a renewable energy source."
        },
        {
          name: "Italy",
          flag: "üáÆüáπ",
          stat: "Consumes espresso at a rate that would terrify most HR departments."
        },
        {
          name: "Brazil",
          flag: "üáßüá∑",
          stat: "Produces a large share of the worlds coffee, powering dashboards like this everywhere."
        },
        {
          name: "Norway",
          flag: "üá≥üá¥",
          stat: "Has some of the worlds longest tunnels, yet still fewer than your folder structure."
        }
      ];

      const chosen = randomFrom(countries);

      const headlineVariants = [
        "Most recent imaginary order came from " + chosen.name + ".",
        "New territory acquired on a very optimistic sales slide: " + chosen.name + ".",
        "Reported as a growth market in at least one confident conversation: " + chosen.name + ".",
        "Flag added to the slide deck before an actual customer: " + chosen.name + "."
      ];

      document.getElementById("flag-emoji").textContent = chosen.flag;
      document.getElementById("flag-main").textContent = chosen.name;
      document.getElementById("flag-sub").textContent = chosen.stat;
      document.getElementById("flag-meta").textContent = randomFrom(headlineVariants);
    }

    document.addEventListener("DOMContentLoaded", () => {
      generateKpis();
      generateChart();
      generateTable();
      loadGifAndQuote();
      loadApis();
      loadEmployees();
      loadFlagPanel();
    });
  </script>
</body>
</html>
